<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mortgage Calculator - Daily Smart Tool</title>
    <meta name="description" content="Calculate mortgage payments, interest, and amortization schedule. Free online mortgage calculator.">
    <link rel="stylesheet" href="../style.css">
    <style>
        .mortgage-container {
            max-width: 1000px;
            margin: 0 auto;
        }
        .calc-header {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            padding: 30px;
            border-radius: 15px;
            border: 2px solid #0ea5e9;
            margin-bottom: 30px;
        }
        .calc-summary {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-top: 20px;
        }
        @media (max-width: 768px) {
            .calc-summary {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        .summary-box {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            border: 2px solid #e2e8f0;
        }
        .summary-box.primary {
            border-color: #0ea5e9;
            background: #f0f9ff;
        }
        .summary-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: #0ea5e9;
            margin: 10px 0;
        }
        .summary-label {
            font-size: 0.9rem;
            color: #64748b;
        }
        .calc-inputs {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 30px 0;
        }
        @media (max-width: 768px) {
            .calc-inputs {
                grid-template-columns: 1fr;
            }
        }
        .input-column {
            background: #f8fafc;
            padding: 30px;
            border-radius: 12px;
            border-left: 4px solid #0ea5e9;
        }
        .input-group {
            margin: 25px 0;
        }
        .input-with-slider {
            margin: 20px 0;
        }
        .slider-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        .slider-value {
            font-weight: bold;
            color: #0ea5e9;
        }
        .custom-slider {
            width: 100%;
            height: 10px;
            border-radius: 5px;
            background: #cbd5e1;
            outline: none;
            -webkit-appearance: none;
        }
        .custom-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #0ea5e9;
            cursor: pointer;
            border: 3px solid white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        .slider-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 5px;
            font-size: 0.85rem;
            color: #64748b;
        }
        .loan-breakdown {
            background: #f0fdf4;
            padding: 25px;
            border-radius: 12px;
            border: 2px solid #10b981;
            margin: 30px 0;
        }
        .breakdown-chart {
            display: flex;
            height: 40px;
            border-radius: 8px;
            overflow: hidden;
            margin: 20px 0;
            border: 2px solid #e2e8f0;
        }
        .chart-segment {
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 0.9rem;
            transition: width 0.5s ease;
        }
        .chart-segment.principal {
            background: #0ea5e9;
        }
        .chart-segment.interest {
            background: #10b981;
        }
        .chart-segment.tax {
            background: #f59e0b;
        }
        .chart-segment.insurance {
            background: #8b5cf6;
        }
        .payment-schedule {
            margin: 40px 0;
        }
        .schedule-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid #e2e8f0;
            padding-bottom: 10px;
        }
        .schedule-tab {
            padding: 12px 24px;
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            border-radius: 8px 8px 0 0;
            cursor: pointer;
            transition: all 0.3s;
        }
        .schedule-tab:hover {
            background: #f1f5f9;
        }
        .schedule-tab.active {
            background: #0ea5e9;
            color: white;
            border-color: #0284c7;
        }
        .schedule-table {
            overflow-x: auto;
        }
        .amortization-table {
            width: 100%;
            border-collapse: collapse;
        }
        .amortization-table th {
            background: #f8fafc;
            padding: 15px;
            text-align: left;
            border-bottom: 2px solid #e2e8f0;
            font-weight: 600;
        }
        .amortization-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #e2e8f0;
        }
        .amortization-table tr:hover {
            background: #f0f9ff;
        }
        .extra-payments {
            background: #fefce8;
            padding: 25px;
            border-radius: 12px;
            border: 2px solid #f59e0b;
            margin: 30px 0;
        }
        .payment-impact {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-top: 20px;
        }
        .impact-box {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            border: 1px solid #e2e8f0;
        }
        .impact-value {
            font-size: 1.5rem;
            font-weight: bold;
            margin: 10px 0;
        }
        .impact-value.savings {
            color: #10b981;
        }
        .impact-value.time {
            color: #0ea5e9;
        }
        .affordability-calc {
            background: #faf5ff;
            padding: 25px;
            border-radius: 12px;
            border: 2px solid #8b5cf6;
            margin: 30px 0;
        }
        .affordability-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-top: 20px;
        }
        @media (max-width: 768px) {
            .affordability-grid {
                grid-template-columns: 1fr;
            }
            .payment-impact {
                grid-template-columns: 1fr;
            }
        }
        .affordability-item {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }
        .loan-types {
            display: flex;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        .loan-type-btn {
            padding: 10px 20px;
            background: #e2e8f0;
            border: 2px solid #cbd5e1;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }
        .loan-type-btn:hover {
            background: #cbd5e1;
        }
        .loan-type-btn.active {
            background: #0ea5e9;
            color: white;
            border-color: #0284c7;
        }
        .rate-trends {
            margin: 30px 0;
            padding: 25px;
            background: #f8fafc;
            border-radius: 12px;
        }
        .trend-chart {
            height: 150px;
            margin: 20px 0;
            position: relative;
            background: white;
            border-radius: 8px;
            padding: 15px;
            border: 1px solid #e2e8f0;
        }
        .trend-line {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 100%;
            display: flex;
            align-items: flex-end;
        }
        .trend-point {
            flex: 1;
            background: #0ea5e9;
            border-radius: 4px 4px 0 0;
            margin: 0 1px;
            position: relative;
        }
        .trend-label {
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.8rem;
            color: #64748b;
            white-space: nowrap;
        }
    </style>
</head>
<body>
    <header>
        <div class="container header-container">
            <a href="../index.html" class="logo">
                <div class="logo-icon">‚öôÔ∏è</div>
                <span>Daily Smart Tool</span>
            </a>
            <button class="mobile-menu-btn">‚ò∞</button>
            <button class="theme-toggle" title="Toggle dark mode">üåô</button>
            <nav>
                <ul>
                    <li><a href="../index.html">Home</a></li>
                    <li><a href="../all-tools.html">All Tools</a></li>
                    <li><a href="../tools/text/text-case-converter.html">Text Tools</a></li>
                    <li><a href="../tools/image/image-resizer.html">Image Tools</a></li>
                    <li><a href="loan-calculator.html">Calculators</a></li>
                    <li><a href="../tools/converters/unit-converter.html">Converters</a></li>
                    <li><a href="../tools/generators/password-generator.html">Generators</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <section class="breadcrumb">
        <div class="container">
            <ul>
                <li><a href="../index.html">Home</a></li>
                <li class="separator">/</li>
                <li><a href="../all-tools.html">All Tools</a></li>
                <li class="separator">/</li>
                <li><a href="loan-calculator.html">Calculators</a></li>
                <li class="separator">/</li>
                <li>Mortgage Calculator</li>
            </ul>
        </div>
    </section>

    <main class="container">
        <section class="tool-page">
            <div class="tool-header">
                <h1>Mortgage Calculator</h1>
                <p>Calculate monthly payments, total interest, and amortization schedule for your mortgage.</p>
            </div>
            
            <div class="tool-container">
                <div class="tool-main">
                    <div class="mortgage-container">
                        <!-- Calculator Header -->
                        <div class="calc-header">
                            <h3>Mortgage Payment Summary</h3>
                            <div class="calc-summary">
                                <div class="summary-box primary">
                                    <div class="summary-label">Monthly Payment</div>
                                    <div class="summary-value" id="monthly-payment">$0</div>
                                </div>
                                <div class="summary-box">
                                    <div class="summary-label">Total Interest</div>
                                    <div class="summary-value" id="total-interest">$0</div>
                                </div>
                                <div class="summary-box">
                                    <div class="summary-label">Total Payment</div>
                                    <div class="summary-value" id="total-payment">$0</div>
                                </div>
                                <div class="summary-box">
                                    <div class="summary-label">Pay-off Date</div>
                                    <div class="summary-value" id="payoff-date">-</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Input Columns -->
                        <div class="calc-inputs">
                            <!-- Left Column: Loan Details -->
                            <div class="input-column">
                                <h3>Loan Details</h3>
                                
                                <div class="input-group">
                                    <div class="slider-header">
                                        <label>Home Price</label>
                                        <div class="slider-value">$<span id="home-price-value">300,000</span></div>
                                    </div>
                                    <input type="range" id="home-price" class="custom-slider" min="50000" max="2000000" step="10000" value="300000">
                                    <div class="slider-labels">
                                        <span>$50K</span>
                                        <span>$1M</span>
                                        <span>$2M</span>
                                    </div>
                                </div>
                                
                                <div class="input-group">
                                    <div class="slider-header">
                                        <label>Down Payment</label>
                                        <div class="slider-value"><span id="down-payment-value">20</span>%</div>
                                    </div>
                                    <input type="range" id="down-payment" class="custom-slider" min="0" max="50" step="1" value="20">
                                    <div class="slider-labels">
                                        <span>0%</span>
                                        <span>25%</span>
                                        <span>50%</span>
                                    </div>
                                    <div style="margin-top: 10px;">
                                        Down Payment Amount: <strong id="down-amount">$60,000</strong>
                                    </div>
                                </div>
                                
                                <div class="input-group">
                                    <div class="slider-header">
                                        <label>Loan Term</label>
                                        <div class="slider-value"><span id="loan-term-value">30</span> years</div>
                                    </div>
                                    <input type="range" id="loan-term" class="custom-slider" min="10" max="40" step="5" value="30">
                                    <div class="slider-labels">
                                        <span>10 years</span>
                                        <span>25 years</span>
                                        <span>40 years</span>
                                    </div>
                                </div>
                                
                                <div class="loan-types">
                                    <div class="loan-type-btn active" data-term="30">30-year Fixed</div>
                                    <div class="loan-type-btn" data-term="15">15-year Fixed</div>
                                    <div class="loan-type-btn" data-term="10">10-year Fixed</div>
                                    <div class="loan-type-btn" data-term="20">20-year Fixed</div>
                                </div>
                            </div>
                            
                            <!-- Right Column: Additional Costs -->
                            <div class="input-column">
                                <h3>Interest & Additional Costs</h3>
                                
                                <div class="input-group">
                                    <div class="slider-header">
                                        <label>Interest Rate</label>
                                        <div class="slider-value"><span id="interest-rate-value">4.5</span>%</div>
                                    </div>
                                    <input type="range" id="interest-rate" class="custom-slider" min="1" max="10" step="0.1" value="4.5">
                                    <div class="slider-labels">
                                        <span>1%</span>
                                        <span>5.5%</span>
                                        <span>10%</span>
                                    </div>
                                </div>
                                
                                <div class="input-group">
                                    <div class="slider-header">
                                        <label>Property Tax</label>
                                        <div class="slider-value">$<span id="property-tax-value">3,000</span>/yr</div>
                                    </div>
                                    <input type="range" id="property-tax" class="custom-slider" min="0" max="20000" step="100" value="3000">
                                    <div class="slider-labels">
                                        <span>$0</span>
                                        <span>$10K</span>
                                        <span>$20K</span>
                                    </div>
                                </div>
                                
                                <div class="input-group">
                                    <div class="slider-header">
                                        <label>Home Insurance</label>
                                        <div class="slider-value">$<span id="insurance-value">1,200</span>/yr</div>
                                    </div>
                                    <input type="range" id="home-insurance" class="custom-slider" min="0" max="5000" step="100" value="1200">
                                    <div class="slider-labels">
                                        <span>$0</span>
                                        <span>$2.5K</span>
                                        <span>$5K</span>
                                    </div>
                                </div>
                                
                                <div class="input-group">
                                    <label>PMI (Private Mortgage Insurance)</label>
                                    <select id="pmi-rate" style="width: 100%; padding: 12px; margin-top: 10px; border-radius: 8px; border: 2px solid #cbd5e1;">
                                        <option value="0">No PMI (20%+ down payment)</option>
                                        <option value="0.5">0.5% (15-19.99% down)</option>
                                        <option value="0.75">0.75% (10-14.99% down)</option>
                                        <option value="1.0" selected>1.0% (5-9.99% down)</option>
                                        <option value="1.5">1.5% (3-4.99% down)</option>
                                        <option value="2.0">2.0% (Less than 3% down)</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Loan Breakdown -->
                        <div class="loan-breakdown">
                            <h3>Loan Breakdown</h3>
                            <div class="breakdown-chart" id="breakdown-chart">
                                <!-- Chart segments will be inserted here -->
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-top: 20px;">
                                <div>
                                    <strong>Loan Amount:</strong> <span id="loan-amount">$240,000</span><br>
                                    <strong>Interest Rate:</strong> <span id="display-rate">4.5%</span>
                                </div>
                                <div style="text-align: right;">
                                    <strong>Monthly Breakdown:</strong><br>
                                    Principal & Interest: <span id="pi-payment">$0</span><br>
                                    Taxes & Insurance: <span id="ti-payment">$0</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Action Buttons -->
                        <div class="tool-buttons" style="text-align: center; margin: 30px 0;">
                            <button class="btn btn-primary" id="calculate-btn">Calculate Mortgage</button>
                            <button class="btn btn-secondary" id="reset-btn">Reset to Default</button>
                            <button class="btn btn-success" id="export-btn">Export Results</button>
                            <button class="btn btn-secondary" id="print-btn">Print Summary</button>
                        </div>
                        
                        <!-- Payment Schedule -->
                        <div class="payment-schedule">
                            <h3>Payment Schedule</h3>
                            <div class="schedule-tabs">
                                <div class="schedule-tab active" data-schedule="yearly">Yearly Summary</div>
                                <div class="schedule-tab" data-schedule="monthly">Monthly Details</div>
                                <div class="schedule-tab" data-schedule="amortization">Amortization Table</div>
                            </div>
                            
                            <div class="schedule-table">
                                <table class="amortization-table" id="yearly-table">
                                    <!-- Yearly data will be inserted here -->
                                </table>
                                <table class="amortization-table" id="monthly-table" style="display: none;">
                                    <!-- Monthly data will be inserted here -->
                                </table>
                                <table class="amortization-table" id="amortization-table" style="display: none;">
                                    <!-- Full amortization will be inserted here -->
                                </table>
                            </div>
                        </div>
                        
                        <!-- Extra Payments Calculator -->
                        <div class="extra-payments">
                            <h3>Extra Payments Calculator</h3>
                            <p>See how extra payments can save you money and reduce your loan term:</p>
                            
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px;">
                                <div>
                                    <label>Extra Monthly Payment:</label>
                                    <input type="number" id="extra-payment" value="100" min="0" style="width: 100%; padding: 12px; margin-top: 10px; border-radius: 8px; border: 2px solid #cbd5e1;">
                                </div>
                                <div>
                                    <label>One-time Extra Payment:</label>
                                    <input type="number" id="lump-sum" value="5000" min="0" style="width: 100%; padding: 12px; margin-top: 10px; border-radius: 8px; border: 2px solid #cbd5e1;">
                                </div>
                            </div>
                            
                            <div class="payment-impact">
                                <div class="impact-box">
                                    <div class="title">Interest Saved</div>
                                    <div class="impact-value savings" id="interest-saved">$0</div>
                                </div>
                                <div class="impact-box">
                                    <div class="title">Loan Term Reduced</div>
                                    <div class="impact-value time" id="term-reduced">0 months</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Affordability Calculator -->
                        <div class="affordability-calc">
                            <h3>Home Affordability Calculator</h3>
                            <p>Based on your income, see what home price you can afford:</p>
                            
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px;">
                                <div>
                                    <label>Annual Income:</label>
                                    <input type="number" id="annual-income" value="75000" min="0" style="width: 100%; padding: 12px; margin-top: 10px; border-radius: 8px; border: 2px solid #cbd5e1;">
                                </div>
                                <div>
                                    <label>Monthly Debt Payments:</label>
                                    <input type="number" id="monthly-debt" value="500" min="0" style="width: 100%; padding: 12px; margin-top: 10px; border-radius: 8px; border: 2px solid #cbd5e1;">
                                </div>
                            </div>
                            
                            <div class="affordability-grid">
                                <div class="affordability-item">
                                    <div class="title">28% Rule (Monthly)</div>
                                    <div class="summary-value" id="rule-28">$1,750</div>
                                    <small>Max housing payment</small>
                                </div>
                                <div class="affordability-item">
                                    <div class="title">36% Rule (Total)</div>
                                    <div class="summary-value" id="rule-36">$2,250</div>
                                    <small>Max total debt payment</small>
                                </div>
                                <div class="affordability-item">
                                    <div class="title">Affordable Home Price</div>
                                    <div class="summary-value" id="affordable-price">$350,000</div>
                                    <small>Based on 20% down</small>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Interest Rate Trends -->
                        <div class="rate-trends">
                            <h3>Historical Interest Rate Trends</h3>
                            <div class="trend-chart" id="trend-chart">
                                <!-- Trend chart will be inserted here -->
                            </div>
                        </div>
                        
                        <div class="info-section">
                            <h3>About This Mortgage Calculator</h3>
                            <p>This comprehensive mortgage calculator helps you understand all aspects of your home loan. It calculates monthly payments, total interest, and provides a detailed amortization schedule.</p>
                            
                            <h4>Key Features:</h4>
                            <ul>
                                <li><strong>Complete Payment Breakdown:</strong> See principal, interest, taxes, insurance, and PMI</li>
                                <li><strong>Amortization Schedule:</strong> View yearly and monthly payment details</li>
                                <li><strong>Extra Payments Calculator:</strong> See how extra payments affect your loan</li>
                                <li><strong>Affordability Calculator:</strong> Determine what home price you can afford</li>
                                <li><strong>Historical Rate Trends:</strong> View mortgage rate trends over time</li>
                            </ul>
                            
                            <h4>Common Mortgage Terms:</h4>
                            <ul>
                                <li><strong>Principal:</strong> The original loan amount borrowed</li>
                                <li><strong>Interest:</strong> The cost of borrowing money</li>
                                <li><strong>PMI (Private Mortgage Insurance):</strong> Required if down payment is less than 20%</li>
                                <li><strong>Amortization:</strong> The process of paying off a loan over time through regular payments</li>
                                <li><strong>Escrow:</strong> An account where property taxes and insurance are held</li>
                            </ul>
                            
                            <h4>Mortgage Tips:</h4>
                            <ul>
                                <li>Aim for a 20% down payment to avoid PMI</li>
                                <li>Consider a 15-year mortgage for faster equity buildup and less interest</li>
                                <li>Make one extra payment per year to significantly reduce loan term</li>
                                <li>Shop around for the best interest rates and terms</li>
                                <li>Factor in closing costs (typically 2-5% of home price)</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div class="tool-sidebar">
                    <div class="ad-banner vertical">Ad Space (300x250)</div>
                    
                    <h3>Related Calculators</h3>
                    <ul class="related-tools">
                        <li><a href="loan-calculator.html">‚û§ Loan Calculator</a></li>
                        <li><a href="compound-interest-calculator.html">‚û§ Compound Interest Calculator</a></li>
                        <li><a href="tax-calculator.html">‚û§ Tax Calculator</a></li>
                        <li><a href="percentage-calculator.html">‚û§ Percentage Calculator</a></li>
                    </ul>
                    
                    <div style="background: #f8fafc; padding: 15px; border-radius: 8px; margin-top: 20px;">
                        <h4>Typical Mortgage Terms</h4>
                        <table style="width: 100%; font-size: 0.85rem;">
                            <tr><td>30-year Fixed</td><td style="text-align: right;">Most common</td></tr>
                            <tr><td>15-year Fixed</td><td style="text-align: right;">Lower interest</td></tr>
                            <tr><td>FHA Loan</td><td style="text-align: right;">3.5% down minimum</td></tr>
                            <tr><td>VA Loan</td><td style="text-align: right;">0% down (veterans)</td></tr>
                            <tr><td>Jumbo Loan</td><td style="text-align: right;">>$647,200</td></tr>
                        </table>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-column">
                    <h3>Daily Smart Tool</h3>
                    <p>Your one-stop destination for free online utilities, calculators, converters, and productivity tools.</p>
                </div>
                <div class="footer-column">
                    <h3>Quick Links</h3>
                    <ul class="footer-links">
                        <li><a href="../index.html">Home</a></li>
                        <li><a href="../all-tools.html">All Tools</a></li>
                        <li><a href="../about.html">About Us</a></li>
                        <li><a href="../contact.html">Contact</a></li>
                        <li><a href="../privacy.html">Privacy Policy</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Popular Categories</h3>
                    <ul class="footer-links">
                        <li><a href="../tools/text/text-case-converter.html">Text Tools</a></li>
                        <li><a href="../tools/image/image-resizer.html">Image Tools</a></li>
                        <li><a href="loan-calculator.html">Calculators</a></li>
                        <li><a href="../tools/converters/unit-converter.html">Converters</a></li>
                        <li><a href="../tools/generators/password-generator.html">Generators</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Contact Us</h3>
                    <ul class="footer-links">
                        <li>Email: contact@dailysmarttool.com</li>
                        <li>Feedback: feedback@dailysmarttool.com</li>
                    </ul>
                </div>
            </div>
            <div class="copyright">
                &copy; <script>document.write(new Date().getFullYear())</script> Daily Smart Tool. All rights reserved. | Part of Safetyguide360 Network
            </div>
        </div>
    </footer>

    <script src="../script.js"></script>
    <script>
        // Format currency
        function formatCurrency(amount) {
            return '$' + amount.toFixed(0).replace(/\d(?=(\d{3})+$)/g, '$&,');
        }
        
        // Format currency with decimals
        function formatCurrencyDec(amount) {
            return '$' + amount.toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,');
        }
        
        // Update slider values
        function updateSliderValues() {
            document.getElementById('home-price-value').textContent = 
                parseInt(document.getElementById('home-price').value).toLocaleString();
            document.getElementById('down-payment-value').textContent = 
                parseInt(document.getElementById('down-payment').value);
            document.getElementById('loan-term-value').textContent = 
                parseInt(document.getElementById('loan-term').value);
            document.getElementById('interest-rate-value').textContent = 
                parseFloat(document.getElementById('interest-rate').value).toFixed(1);
            document.getElementById('property-tax-value').textContent = 
                parseInt(document.getElementById('property-tax').value).toLocaleString();
            document.getElementById('insurance-value').textContent = 
                parseInt(document.getElementById('home-insurance').value).toLocaleString();
            
            // Calculate down payment amount
            const homePrice = parseFloat(document.getElementById('home-price').value);
            const downPercent = parseFloat(document.getElementById('down-payment').value) / 100;
            const downAmount = homePrice * downPercent;
            document.getElementById('down-amount').textContent = formatCurrency(downAmount);
        }
        
        // Calculate mortgage
        function calculateMortgage() {
            // Get input values
            const homePrice = parseFloat(document.getElementById('home-price').value);
            const downPercent = parseFloat(document.getElementById('down-payment').value) / 100;
            const loanTerm = parseFloat(document.getElementById('loan-term').value);
            const annualRate = parseFloat(document.getElementById('interest-rate').value) / 100;
            const propertyTax = parseFloat(document.getElementById('property-tax').value);
            const homeInsurance = parseFloat(document.getElementById('home-insurance').value);
            const pmiRate = parseFloat(document.getElementById('pmi-rate').value) / 100;
            
            // Calculate loan amount
            const downAmount = homePrice * downPercent;
            let loanAmount = homePrice - downAmount;
            
            // Calculate PMI if down payment less than 20%
            let pmiMonthly = 0;
            if (downPercent < 0.2) {
                pmiMonthly = (loanAmount * pmiRate) / 12;
            }
            
            // Calculate monthly principal and interest
            const monthlyRate = annualRate / 12;
            const numberOfPayments = loanTerm * 12;
            
            // Mortgage payment formula: P = L[c(1 + c)^n]/[(1 + c)^n - 1]
            const principalInterest = loanAmount * 
                (monthlyRate * Math.pow(1 + monthlyRate, numberOfPayments)) / 
                (Math.pow(1 + monthlyRate, numberOfPayments) - 1);
            
            // Calculate monthly taxes and insurance
            const taxMonthly = propertyTax / 12;
            const insuranceMonthly = homeInsurance / 12;
            
            // Total monthly payment
            const totalMonthly = principalInterest + taxMonthly + insuranceMonthly + pmiMonthly;
            
            // Calculate total payments
            const totalPayment = totalMonthly * numberOfPayments;
            const totalInterest = (principalInterest * numberOfPayments) - loanAmount;
            
            // Calculate payoff date
            const today = new Date();
            const payoffDate = new Date(today);
            payoffDate.setMonth(payoffDate.getMonth() + numberOfPayments);
            
            // Update summary
            document.getElementById('monthly-payment').textContent = formatCurrencyDec(totalMonthly);
            document.getElementById('total-interest').textContent = formatCurrency(totalInterest);
            document.getElementById('total-payment').textContent = formatCurrency(totalPayment);
            document.getElementById('payoff-date').textContent = payoffDate.toLocaleDateString('en-US', { 
                month: 'short', 
                year: 'numeric' 
            });
            
            // Update loan details
            document.getElementById('loan-amount').textContent = formatCurrency(loanAmount);
            document.getElementById('display-rate').textContent = (annualRate * 100).toFixed(2) + '%';
            document.getElementById('pi-payment').textContent = formatCurrencyDec(principalInterest);
            document.getElementById('ti-payment').textContent = formatCurrencyDec(taxMonthly + insuranceMonthly);
            
            // Update breakdown chart
            updateBreakdownChart(principalInterest, taxMonthly, insuranceMonthly, pmiMonthly);
            
            // Generate payment schedules
            generatePaymentSchedules(loanAmount, annualRate, loanTerm, totalMonthly);
            
            // Calculate extra payment impact
            calculateExtraPayments(loanAmount, annualRate, loanTerm, principalInterest);
            
            // Calculate affordability
            calculateAffordability();
            
            // Update trend chart
            updateTrendChart();
        }
        
        // Update breakdown chart
        function updateBreakdownChart(principalInterest, taxMonthly, insuranceMonthly, pmiMonthly) {
            const chart = document.getElementById('breakdown-chart');
            chart.innerHTML = '';
            
            const total = principalInterest + taxMonthly + insuranceMonthly + pmiMonthly;
            const segments = [
                { value: principalInterest, label: 'Principal & Interest', class: 'principal' },
                { value: taxMonthly, label: 'Property Tax', class: 'tax' },
                { value: insuranceMonthly, label: 'Insurance', class: 'insurance' },
                { value: pmiMonthly, label: 'PMI', class: 'interest' }
            ];
            
            // Filter out zero values
            const activeSegments = segments.filter(seg => seg.value > 0);
            
            activeSegments.forEach(seg => {
                const width = (seg.value / total) * 100;
                const segment = document.createElement('div');
                segment.className = `chart-segment ${seg.class}`;
                segment.style.width = `${width}%`;
                segment.textContent = `${seg.label}: ${formatCurrencyDec(seg.value)}`;
                chart.appendChild(segment);
            });
        }
        
        // Generate payment schedules
        function generatePaymentSchedules(loanAmount, annualRate, loanTerm, totalMonthly) {
            const monthlyRate = annualRate / 12;
            const numberOfPayments = loanTerm * 12;
            let balance = loanAmount;
            
            // Yearly table
            const yearlyTable = document.getElementById('yearly-table');
            yearlyTable.innerHTML = `
                <tr>
                    <th>Year</th>
                    <th>Beginning Balance</th>
                    <th>Interest Paid</th>
                    <th>Principal Paid</th>
                    <th>Ending Balance</th>
                    <th>Cumulative Interest</th>
                </tr>
            `;
            
            // Monthly table (first year)
            const monthlyTable = document.getElementById('monthly-table');
            monthlyTable.innerHTML = `
                <tr>
                    <th>Month</th>
                    <th>Payment</th>
                    <th>Interest</th>
                    <th>Principal</th>
                    <th>Balance</th>
                </tr>
            `;
            
            // Full amortization table
            const amortizationTable = document.getElementById('amortization-table');
            amortizationTable.innerHTML = `
                <tr>
                    <th>Payment #</th>
                    <th>Payment Date</th>
                    <th>Payment</th>
                    <th>Principal</th>
                    <th>Interest</th>
                    <th>Balance</th>
                </tr>
            `;
            
            let cumulativeInterest = 0;
            const startDate = new Date();
            
            for (let year = 1; year <= loanTerm; year++) {
                let yearInterest = 0;
                let yearPrincipal = 0;
                const yearStartBalance = balance;
                
                for (let month = 1; month <= 12; month++) {
                    const paymentNumber = (year - 1) * 12 + month;
                    
                    // Calculate interest for this month
                    const interest = balance * monthlyRate;
                    const principal = totalMonthly - interest;
                    
                    yearInterest += interest;
                    yearPrincipal += principal;
                    cumulativeInterest += interest;
                    balance -= principal;
                    
                    // Add to monthly table (first year only)
                    if (year === 1) {
                        const paymentDate = new Date(startDate);
                        paymentDate.setMonth(paymentDate.getMonth() + month);
                        
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td>${month}</td>
                            <td>${formatCurrencyDec(totalMonthly)}</td>
                            <td>${formatCurrencyDec(interest)}</td>
                            <td>${formatCurrencyDec(principal)}</td>
                            <td>${formatCurrency(balance)}</td>
                        `;
                        monthlyTable.appendChild(row);
                    }
                    
                    // Add to full amortization table (every 12th payment)
                    if (paymentNumber % 12 === 0 || paymentNumber === 1 || paymentNumber === numberOfPayments) {
                        const paymentDate = new Date(startDate);
                        paymentDate.setMonth(paymentDate.getMonth() + paymentNumber);
                        
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td>${paymentNumber}</td>
                            <td>${paymentDate.toLocaleDateString('en-US', { month: 'short', year: 'numeric' })}</td>
                            <td>${formatCurrencyDec(totalMonthly)}</td>
                            <td>${formatCurrencyDec(principal)}</td>
                            <td>${formatCurrencyDec(interest)}</td>
                            <td>${formatCurrency(balance)}</td>
                        `;
                        amortizationTable.appendChild(row);
                    }
                    
                    if (balance <= 0) break;
                }
                
                // Add to yearly table
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${year}</td>
                    <td>${formatCurrency(yearStartBalance)}</td>
                    <td>${formatCurrency(yearInterest)}</td>
                    <td>${formatCurrency(yearPrincipal)}</td>
                    <td>${formatCurrency(balance)}</td>
                    <td>${formatCurrency(cumulativeInterest)}</td>
                `;
                yearlyTable.appendChild(row);
                
                if (balance <= 0) break;
            }
        }
        
        // Calculate extra payments impact
        function calculateExtraPayments(loanAmount, annualRate, loanTerm, basePayment) {
            const extraMonthly = parseFloat(document.getElementById('extra-payment').value) || 0;
            const lumpSum = parseFloat(document.getElementById('lump-sum').value) || 0;
            
            const monthlyRate = annualRate / 12;
            let balance = loanAmount - lumpSum;
            let months = 0;
            let totalInterest = 0;
            
            // Calculate with extra payments
            while (balance > 0 && months < loanTerm * 12) {
                months++;
                const interest = balance * monthlyRate;
                const principal = basePayment + extraMonthly - interest;
                
                totalInterest += interest;
                balance -= principal;
                
                if (balance <= 0) break;
            }
            
            // Calculate without extra payments
            const standardMonths = loanTerm * 12;
            const standardInterest = (basePayment * standardMonths) - loanAmount;
            
            // Calculate savings
            const interestSaved = standardInterest - totalInterest;
            const monthsSaved = standardMonths - months;
            
            // Update display
            document.getElementById('interest-saved').textContent = formatCurrency(interestSaved);
            document.getElementById('term-reduced').textContent = `${monthsSaved} months (${Math.floor(monthsSaved/12)} years)`;
        }
        
        // Calculate affordability
        function calculateAffordability() {
            const annualIncome = parseFloat(document.getElementById('annual-income').value) || 0;
            const monthlyDebt = parseFloat(document.getElementById('monthly-debt').value) || 0;
            
            // 28% rule: housing costs should not exceed 28% of gross monthly income
            const monthlyIncome = annualIncome / 12;
            const maxHousingPayment = monthlyIncome * 0.28;
            
            // 36% rule: total debt should not exceed 36% of gross monthly income
            const maxTotalDebt = monthlyIncome * 0.36;
            const maxMortgagePayment = maxTotalDebt - monthlyDebt;
            
            // Use the more restrictive limit
            const affordablePayment = Math.min(maxHousingPayment, maxMortgagePayment);
            
            // Calculate affordable home price based on current loan terms
            const homePrice = parseFloat(document.getElementById('home-price').value);
            const downPercent = parseFloat(document.getElementById('down-payment').value) / 100;
            const loanTerm = parseFloat(document.getElementById('loan-term').value);
            const annualRate = parseFloat(document.getElementById('interest-rate').value) / 100;
            const propertyTax = parseFloat(document.getElementById('property-tax').value) / 12;
            const homeInsurance = parseFloat(document.getElementById('home-insurance').value) / 12;
            const pmiRate = parseFloat(document.getElementById('pmi-rate').value) / 100;
            
            // Back-calculate loan amount from affordable payment
            const monthlyRate = annualRate / 12;
            const numberOfPayments = loanTerm * 12;
            
            // Subtract taxes and insurance from affordable payment
            let availableForPI = affordablePayment - propertyTax - homeInsurance;
            
            // Adjust for PMI if down payment less than 20%
            if (downPercent < 0.2) {
                // This is complex to back-calculate, so we'll estimate
                availableForPI *= 0.95; // Approximate adjustment for PMI
            }
            
            // Calculate maximum loan amount
            const maxLoanAmount = availableForPI * 
                (Math.pow(1 + monthlyRate, numberOfPayments) - 1) / 
                (monthlyRate * Math.pow(1 + monthlyRate, numberOfPayments));
            
            // Calculate affordable home price
            const affordableHomePrice = maxLoanAmount / (1 - downPercent);
            
            // Update display
            document.getElementById('rule-28').textContent = formatCurrencyDec(maxHousingPayment);
            document.getElementById('rule-36').textContent = formatCurrencyDec(maxTotalDebt);
            document.getElementById('affordable-price').textContent = formatCurrency(affordableHomePrice);
        }
        
        // Update trend chart
        function updateTrendChart() {
            const chart = document.getElementById('trend-chart');
            chart.innerHTML = '';
            
            // Historical mortgage rates (last 10 years, sample data)
            const historicalRates = [
                { year: '2014', rate: 4.17 },
                { year: '2015', rate: 3.85 },
                { year: '2016', rate: 3.65 },
                { year: '2017', rate: 3.99 },
                { year: '2018', rate: 4.54 },
                { year: '2019', rate: 3.94 },
                { year: '2020', rate: 3.11 },
                { year: '2021', rate: 2.96 },
                { year: '2022', rate: 5.34 },
                { year: '2023', rate: 6.81 },
                { year: '2024', rate: 6.61 }
            ];
            
            // Current rate
            const currentRate = parseFloat(document.getElementById('interest-rate').value);
            
            const trendLine = document.createElement('div');
            trendLine.className = 'trend-line';
            
            // Find max rate for scaling
            const maxRate = Math.max(...historicalRates.map(r => r.rate), currentRate);
            
            historicalRates.forEach((data, index) => {
                const height = (data.rate / maxRate) * 100;
                const point = document.createElement('div');
                point.className = 'trend-point';
                point.style.height = `${height}%`;
                
                // Add label for every other point
                if (index % 2 === 0) {
                    const label = document.createElement('div');
                    label.className = 'trend-label';
                    label.textContent = data.year;
                    point.appendChild(label);
                }
                
                trendLine.appendChild(point);
            });
            
            // Add current rate point
            const currentHeight = (currentRate / maxRate) * 100;
            const currentPoint = document.createElement('div');
            currentPoint.className = 'trend-point';
            currentPoint.style.height = `${currentHeight}%`;
            currentPoint.style.background = '#10b981';
            
            const currentLabel = document.createElement('div');
            currentLabel.className = 'trend-label';
            currentLabel.textContent = 'Your Rate';
            currentLabel.style.fontWeight = 'bold';
            currentPoint.appendChild(currentLabel);
            
            trendLine.appendChild(currentPoint);
            chart.appendChild(trendLine);
        }
        
        // Event Listeners
        // Slider inputs
        document.querySelectorAll('.custom-slider, select, input[type="number"]').forEach(input => {
            input.addEventListener('input', () => {
                updateSliderValues();
                calculateMortgage();
            });
        });
        
        // Loan type buttons
        document.querySelectorAll('.loan-type-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.loan-type-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                document.getElementById('loan-term').value = btn.getAttribute('data-term');
                updateSliderValues();
                calculateMortgage();
            });
        });
        
        // Schedule tabs
        document.querySelectorAll('.schedule-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                // Update active tab
                document.querySelectorAll('.schedule-tab').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                
                // Show corresponding table
                const scheduleType = tab.getAttribute('data-schedule');
                document.getElementById('yearly-table').style.display = 'none';
                document.getElementById('monthly-table').style.display = 'none';
                document.getElementById('amortization-table').style.display = 'none';
                document.getElementById(`${scheduleType}-table`).style.display = 'table';
            });
        });
        
        // Calculate button
        document.getElementById('calculate-btn').addEventListener('click', calculateMortgage);
        
        // Reset button
        document.getElementById('reset-btn').addEventListener('click', () => {
            document.getElementById('home-price').value = 300000;
            document.getElementById('down-payment').value = 20;
            document.getElementById('loan-term').value = 30;
            document.getElementById('interest-rate').value = 4.5;
            document.getElementById('property-tax').value = 3000;
            document.getElementById('home-insurance').value = 1200;
            document.getElementById('pmi-rate').value = 1.0;
            document.getElementById('extra-payment').value = 100;
            document.getElementById('lump-sum').value = 5000;
            document.getElementById('annual-income').value = 75000;
            document.getElementById('monthly-debt').value = 500;
            
            updateSliderValues();
            calculateMortgage();
        });
        
        // Export button
        document.getElementById('export-btn').addEventListener('click', () => {
            const data = {
                homePrice: document.getElementById('home-price').value,
                downPayment: document.getElementById('down-payment').value,
                loanTerm: document.getElementById('loan-term').value,
                interestRate: document.getElementById('interest-rate').value,
                monthlyPayment: document.getElementById('monthly-payment').textContent,
                totalInterest: document.getElementById('total-interest').textContent,
                totalPayment: document.getElementById('total-payment').textContent,
                payoffDate: document.getElementById('payoff-date').textContent
            };
            
            const dataStr = JSON.stringify(data, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const exportFileDefaultName = 'mortgage-calculator-results.json';
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
        });
        
        // Print button
        document.getElementById('print-btn').addEventListener('click', () => {
            window.print();
        });
        
        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            updateSliderValues();
            calculateMortgage();
        });
    </script>
</body>
</html>